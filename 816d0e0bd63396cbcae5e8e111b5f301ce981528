{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "56210a18_c7ce516d",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-11-02T08:26:06Z",
      "side": 1,
      "message": "In line 47, the version is queried before checking whether it has been implemented or not. Before querying the version, I think this check needs to be done. Same at line no. 26 and 71.",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5aad3a8_03285ef4",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000660
      },
      "writtenOn": "2022-11-02T14:07:15Z",
      "side": 1,
      "message": "As per the spec, the presence of the TRNG ABI is discovered by calling TRNG_VERSION. So that is the first action to be done before calling any other APIS. Once that passes, it ensures ABI is present and then we could proceed and test other functions.\nSo based on this I think the current implementation is fine.",
      "parentUuid": "56210a18_c7ce516d",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3ae61e29_5d35145b",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-11-02T14:45:48Z",
      "side": 1,
      "message": "Agree that version check is important before calling any other APIs.\nHowever, line no. 47, issuing TRNG Version SMC call, and then checking if TRNG version SMC is implemented or not does not sound good to me. \n\u0027tftf_trng_feature_implemented(SMC_TRNG_VERSION)\u0027 should have been called before issuing TRNG version SMC within \u0027tftf_trng_version\u0027.\n\nFeel free to ignore this comment as it is not related to your change.",
      "parentUuid": "a5aad3a8_03285ef4",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e5f5ab62_aacbbdc4",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000660
      },
      "writtenOn": "2022-11-02T17:11:30Z",
      "side": 1,
      "message": "Ah ok. Now it makes sense to me.\nWhen you mentioned line 26 as well as at 71, I was confused.\n\nI think, at line number 53, we first verified ABI is present or not and then testing the fucntions/features.\nIn a way when we call tftf_trng_version(), we are indirectly checking line number 53. Its kind of redundant check not a harm though. \nIf required that could be taken out. Please do let me know your thoughts here.",
      "parentUuid": "3ae61e29_5d35145b",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09154c7e_92ae439d",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-11-02T18:19:25Z",
      "side": 1,
      "message": "\u003e In a way when we call tftf_trng_version(), we are indirectly checking line number 53. Its kind of redundant check not a harm though. \nI mean, the check should be moved from line 53 to the tftf_trng_version function. Currently, tftf_trng_version function issues version SMC without checking if it has been implemented, according to its definition [1]. \n\n[1]: https://git.trustedfirmware.org/TF-A/tf-a-tests.git/tree/lib/trng/trng.c#n24",
      "parentUuid": "e5f5ab62_aacbbdc4",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1decc2b0_bd36097e",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000660
      },
      "writtenOn": "2022-11-08T15:02:25Z",
      "side": 1,
      "message": "Ok.\nI understand it now. You want the tftf_trng_feature_implemented(SMC_TRNG_VERSION) to be called inside tftf_trng_version(void),\nso that before performing the version test, we should ensure whether the API/Feature is implemented or not.\n\nBut ideally, ABI needs to be discovered before any function check.\n\nTRNG_FEATURES:\nAs spec reads: The caller must ensure the TRNG ABI is present before calling this function.\n\nSo to test TRNG_features, tftf_trng_version() to be called first, before calling tftf_trng_feature_implemented();\n\nOn the other side, as you mentioned, at line no: 53, it kind of misleads.\nTRNG_VERSION check is not a feature check, it\u0027s an ABI discovery mechanism.\n\nSo what we could do is, remove line number 53. Check whether \n\t      tftf_trng_feature_implemented(SMC_TRNG_FEATURES) \u0026\u0026\n\t      tftf_trng_feature_implemented(SMC_TRNG_UUID) \u0026\u0026\n\t      tftf_trng_feature_implemented(SMC_TRNG_RND)))\nare implemented or not.\nWould that make it good?",
      "parentUuid": "09154c7e_92ae439d",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aafee13e_60fd0c26",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-11-08T15:18:23Z",
      "side": 1,
      "message": "\u003e TRNG_FEATURES:\n\u003e As spec reads: The caller must ensure the TRNG ABI is present before calling this function.\n\n\u003e So to test TRNG_features, tftf_trng_version() to be called first, before calling tftf_trng_feature_implemented();\n\nOkay.though I\u0027m not sure then when we should check if version SMC has been implemented or not (Specification clearly mentions it is a part of feature). For now, I think it is better to remove line 53, since it is not required.",
      "parentUuid": "1decc2b0_bd36097e",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b498a6af_00a1dbd2",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000660
      },
      "writtenOn": "2022-11-08T15:23:22Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "aafee13e_60fd0c26",
      "range": {
        "startLine": 53,
        "startChar": 5,
        "endLine": 53,
        "endChar": 54
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fb210be0_005a47b7",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 79,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-11-01T14:33:17Z",
      "side": 1,
      "message": "This should be SKIPPED rather than fail right if the feature is not implemented?",
      "range": {
        "startLine": 79,
        "startChar": 9,
        "endLine": 79,
        "endChar": 25
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "89444462_cb50a0af",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 79,
      "author": {
        "id": 1000660
      },
      "writtenOn": "2022-11-01T16:52:42Z",
      "side": 1,
      "message": "As per the TRNG spec 1.0, TRNG_RND function is a mandatory function and it must be present if TRNG ABI version is greater or equal than the\nversion of the ABI the particular function was mandated on. ( v1.0).\n\nSo here, we are testing whether tftf_trng_version( ), is supported or not. If that is supported, that means this trng_rnd must be present. If not it should be fail right ?",
      "parentUuid": "fb210be0_005a47b7",
      "range": {
        "startLine": 79,
        "startChar": 9,
        "endLine": 79,
        "endChar": 25
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "43eaf6c1_be9d0b24",
        "filename": "tftf/tests/runtime_services/standard_service/trng/api_tests/test_trng.c",
        "patchSetId": 1
      },
      "lineNbr": 79,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-11-02T08:26:06Z",
      "side": 1,
      "message": "Ack, thanks. It makes sense then to report this as a failure.",
      "parentUuid": "89444462_cb50a0af",
      "range": {
        "startLine": 79,
        "startChar": 9,
        "endLine": 79,
        "endChar": 25
      },
      "revId": "816d0e0bd63396cbcae5e8e111b5f301ce981528",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}