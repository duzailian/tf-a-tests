{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "233b47a0_33e6eb3b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 10,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2024-07-16T16:03:40Z",
      "side": 1,
      "message": "I see why this is done, however I\u0027m not sure the description/intent is entirely correct.\n\nLooking at https://git.trustedfirmware.org/hafnium/hafnium/+/refs/heads/master/src/arch/aarch64/hypervisor/cpu.c#166\n\nIn context of Hafnium/S-EL2, vmpidr_el2 is fed with a cpu_id_t/uint64_t value (cast from ffa_vcpu_index_t/uint16_t). In this case cactus reads MPIDR_EL1 resolving as the virtual MPIDR value from VMPIDR_EL2.\n\nThe mask has to change in context of cactus run on top of EL3 SPMC, because MPIDR_EL1 now returns the physical MPIDR which may contain additional bits like MT/U compared to S-EL2 SPMC.",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 10,
        "endChar": 57
      },
      "revId": "b32b6af839c4a1bbf29c6ec7d545e48c10ddc469",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}