{
  "comments": [
    {
      "key": {
        "uuid": "61097f48_34358e53",
        "filename": "spm/cactus/cactus_main.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-02T15:57:09Z",
      "side": 1,
      "message": "Why aren\u0027t you adjusting the spmc_id field in the SPMC manifest to the desired value?\nThis would remove necessity for this change.",
      "revId": "dfa4d219a440d59d0063f843cfdf9a8c1132095b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09d614d0_e226c318",
        "filename": "spm/cactus/cactus_main.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-02T18:54:45Z",
      "side": 1,
      "message": "spmc_id is expected to be 0x8000 at other places in the stack. Plus, it is not really clear that spmc_id and VM_id are the same (?)",
      "parentUuid": "61097f48_34358e53",
      "revId": "dfa4d219a440d59d0063f843cfdf9a8c1132095b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9a9dfa96_8fe3a629",
        "filename": "spm/cactus/cactus_main.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-10T08:28:26Z",
      "side": 1,
      "message": "No that\u0027s not the same.\nspmc_id refers to the FF-A ID of the entity running at secure physical FF-A instance e.g. Hafnium or cactus_spmc. It\u0027s meant to be configurable in the platform spmc manifest (or hardcoded in Tegra\u0027s case: plat/nvidia/tegra/common/plat_spmd_manifest.c). In our usages we fix it to 0x8000 but obviously it could theoretically be another value. If can be requested by the SPMC to the SPMD using FFA_ID_GET.\nA VM or SP FF-A id only exists when virtualization is enabled (aka S-EL2 / Hafnium is present), and is the id value of the SP at secure virtual FF-A instance. It can be requested from the SP and returned to the SPMC through FFA_ID_GET. It has no rationale/meaning in the cactus_spmc case because virtual machines do not exist. In Hafnium/SPMC case, SP FF-A ids are counted from 0x8001 to 0xFFFE.\nGenerally, an FF-A component SPMC / VM / SP shall get its FF-A ID using FFA_ID_GET and not assume its own ID statically in the code.",
      "parentUuid": "09d614d0_e226c318",
      "revId": "dfa4d219a440d59d0063f843cfdf9a8c1132095b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2da934ab_e7599d39",
        "filename": "spm/cactus/cactus_main.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-13T04:39:24Z",
      "side": 1,
      "message": "I see. The current code across the stack is biased towards post 8.4 CPUs. We need to do better in supporting pre 8.4 platforms. There\u0027s no other way. We cannot break those platforms.\n\nHaving said that, I think SPMD needs some intelligence to check if FFA_ID_GET is issued by SEL2 or SEL1 and then return the \"right\" value. Does this sound right? I can make that change once you confirm.",
      "parentUuid": "9a9dfa96_8fe3a629",
      "revId": "dfa4d219a440d59d0063f843cfdf9a8c1132095b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "22e30195_0d7663f3",
        "filename": "spm/cactus/cactus_main.c",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-14T08:08:35Z",
      "side": 1,
      "message": "\u003e SPMD needs some intelligence to check if FFA_ID_GET is issued by SEL2 or SEL1\n\nI don\u0027t think that\u0027s a right strategy. The SPMD as a callee is meant to return the SPMC id, and that\u0027s what you get when caller is the SPMC.\nAgain, it boils down to defining exactly what you want to achieve (the sw architecture) with \"cactus SPMC\" (see other more detailed comment).",
      "parentUuid": "2da934ab_e7599d39",
      "revId": "dfa4d219a440d59d0063f843cfdf9a8c1132095b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    }
  ]
}