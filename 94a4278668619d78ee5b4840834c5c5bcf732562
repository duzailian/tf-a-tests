{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d15f6932_c2bef9b6",
        "filename": "tftf/tests/runtime_services/secure_service/test_spm_smmu.c",
        "patchSetId": 4
      },
      "lineNbr": 161,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2024-02-07T10:10:40Z",
      "side": 1,
      "message": "I believe the test fails because:\n* the operation added line #100 results in a successful translation for PLAT_CACTUS_NS_MEMCPY_BASE address with a given set of attributes and are cached into the SMMU TLB.\n* the second operation line 157 uses different attributes for the same destination address but SMMU re-uses attributes that were cached in the TLB.\n\nMoreover the PAS change at line 143 using TLBI by PA should be broadcasted to the SMMU which isn\u0027t done with default FVP options. Using -C cci550.force_on_from_start\u003d1 setups the interconnect such that TBLI by PA operations are broadcasted. Using this option effectively makes the test pass.",
      "range": {
        "startLine": 161,
        "startChar": 2,
        "endLine": 161,
        "endChar": 39
      },
      "revId": "94a4278668619d78ee5b4840834c5c5bcf732562",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2814e0d_e637baad",
        "filename": "tftf/tests/runtime_services/secure_service/test_spm_smmu.c",
        "patchSetId": 4
      },
      "lineNbr": 161,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2024-02-07T10:32:50Z",
      "side": 1,
      "message": "Actually ignore bullet #2.\nThe exact reason is:\nOperation line #100 results in a successful translation hence cached in the SMMU TLB **including the NS PAS**.\nPAS change line 143 from PE doesn\u0027t broadcast to the SMMU TLB.\nOperation line 157 re-uses **NS PAS attribute** from the SMMU TLB hit and results in the transaction passing whereas the test expects failure (because the region should have behaved as realm).\nThe conclusion remains the same about the FVP command line option.",
      "parentUuid": "d15f6932_c2bef9b6",
      "range": {
        "startLine": 161,
        "startChar": 2,
        "endLine": 161,
        "endChar": 39
      },
      "revId": "94a4278668619d78ee5b4840834c5c5bcf732562",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "577c4052_0c99f44e",
        "filename": "tftf/tests/runtime_services/secure_service/test_spm_smmu.c",
        "patchSetId": 4
      },
      "lineNbr": 161,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2024-02-07T15:14:49Z",
      "side": 1,
      "message": "Hi Olivier,\nThanks a lot for the detailed response.",
      "parentUuid": "c2814e0d_e637baad",
      "range": {
        "startLine": 161,
        "startChar": 2,
        "endLine": 161,
        "endChar": 39
      },
      "revId": "94a4278668619d78ee5b4840834c5c5bcf732562",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "789bedb4_ab4ed744",
        "filename": "tftf/tests/runtime_services/secure_service/test_spm_smmu.c",
        "patchSetId": 4
      },
      "lineNbr": 161,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2024-02-07T18:22:06Z",
      "side": 1,
      "message": "Pushed a fix here: https://review.trustedfirmware.org/c/ci/tf-a-ci-scripts/+/26427",
      "parentUuid": "577c4052_0c99f44e",
      "range": {
        "startLine": 161,
        "startChar": 2,
        "endLine": 161,
        "endChar": 39
      },
      "revId": "94a4278668619d78ee5b4840834c5c5bcf732562",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}