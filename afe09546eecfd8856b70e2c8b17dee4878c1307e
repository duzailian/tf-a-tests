{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e25299a1_7917a55a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-25T14:51:54Z",
      "side": 1,
      "message": "Generally looks okay to me except for the location where interrupt is declared..",
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c4e1c913_18629b8f",
        "filename": "plat/arm/fvp/include/platform_def.h",
        "patchSetId": 3
      },
      "lineNbr": 44,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2023-09-19T12:12:18Z",
      "side": 1,
      "message": "The naming does not align with the fact that we are adding one more interrupt to the wdog node. Should this be IRQ_TWDOG_...?",
      "range": {
        "startLine": 44,
        "startChar": 8,
        "endLine": 44,
        "endChar": 27
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3656b250_80f9c532",
        "filename": "plat/arm/fvp/include/platform_def.h",
        "patchSetId": 3
      },
      "lineNbr": 44,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-09-19T14:18:29Z",
      "side": 1,
      "message": "As summarized by Olivier in other review comment, this ESPI is not related to TWDOG peripheral.",
      "parentUuid": "c4e1c913_18629b8f",
      "range": {
        "startLine": 44,
        "startChar": 8,
        "endLine": 44,
        "endChar": 27
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5182ab45_b46acf94",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2023-09-19T12:12:18Z",
      "side": 1,
      "message": "Are we implying that the SP805 module also supports an ESPI? What would it take to make this test generic so that other platforms that do not have SP805 can also run it?",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5794e3f1_6936b11c",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2023-09-19T12:26:39Z",
      "side": 1,
      "message": "This is a valid remark!\nThe added interrupt is not related to SP805. Madhu added a test facility to pend an (extended) SPI ID from EL3, but this isn\u0027t wired to any peripheral. So we should either make it clear through comments,\nOr alternatively create a dedicated device-region test node? The problem being that it doesn\u0027t have any MMIO mapping to declare, just an INTID.",
      "parentUuid": "5182ab45_b46acf94",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0a0f8d35_78bf729b",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-09-19T14:18:29Z",
      "side": 1,
      "message": "Thanks for the response, Olivier.\nIf its okay with everyone, I will add a comment justifying the need to add this interrup to the device region node. Please let me know.",
      "parentUuid": "5794e3f1_6936b11c",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a42dd67a_9d6c82d2",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2023-09-19T14:38:09Z",
      "side": 1,
      "message": "I vote to add a new node for this interrupt entry",
      "parentUuid": "0a0f8d35_78bf729b",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a00ae1ed_646eec8b",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-09-19T20:18:45Z",
      "side": 1,
      "message": "I am not sure creating a dedicated device-region node is a good idea since it is supposed to represent a peripheral device. We need to populate it with mandotary fields such as base-address, page count, attributes etc. But the ESPI interrupt for the FVP platform has nothing to do with this new device region.",
      "parentUuid": "a42dd67a_9d6c82d2",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "009b7dfd_3ff0d77d",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-09-22T18:51:23Z",
      "side": 1,
      "message": "@Varun, let me know your opinion.",
      "parentUuid": "a00ae1ed_646eec8b",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e21df81d_ac42e0f1",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2023-09-25T08:49:34Z",
      "side": 1,
      "message": "I think there is value is separating the PPI from the WDT node. Due to the restriction Madhu described, we will have to introduce a dummy node.",
      "parentUuid": "009b7dfd_3ff0d77d",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b2b49564_ad66b2b7",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-25T14:51:54Z",
      "side": 1,
      "message": "i sort of agree with Varun. it is misleading to put the interrupt with the sec_wdog. We need a way to declare an interrupt without it being tied to a device and having to declare dummy base address or pages etc. I think that can be a follow on patch, but i can see legitimate use cases where a SW component wants to trigger an interrupt.\nPerhaps this can be a shared region of memory between 2 SPs (so in this cactus case, we reserve a region accessible between different cactus instances) and associate an interrupt with it.",
      "parentUuid": "e21df81d_ac42e0f1",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c396c8d9_002d108e",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2023-09-25T15:15:12Z",
      "side": 1,
      "message": "\u003e We need a way to declare an interrupt without it being tied to a device and having to declare dummy base address or pages etc.\nI see what I you mean and why. Just to state this is just a little bit off spec as a device region has base address and page count specified as mandatory fields.\n\u003e Perhaps this can be a shared region of memory between 2 SPs\nI\u0027m not sure I see where it relates to this problem.\nNote sharing memory can only be achieved with mem sharing primitives. As things stand, it\u0027s not possible/valid to declare the same or overlapping memory region in two different SP manifests.",
      "parentUuid": "b2b49564_ad66b2b7",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "efe1f840_0b0d20db",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-25T15:21:11Z",
      "side": 1,
      "message": "agree, was giving an example where we have a dummy memory region that is really in memory like DRAM/SRAM/TCM, but not a real device, and we associate an interrupt with it. I\u0027m curious (and off topic) why we want to force memory sharing primitives and why we dont want to share memory using manifests. I dont see any harm in that. did we add a check for this recently (vaguely remember we did)?\nI will check internally again, but i\u0027m pretty sure we are doing this to share memory between SPs instead of using mem sharing primitives (which are complicated IMO).",
      "parentUuid": "c396c8d9_002d108e",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15a46235_3501bd0f",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-09-26T14:14:31Z",
      "side": 1,
      "message": "I appreciate the feedback but looks like it is moving in a tangential direction with respect to the feature we are looking to exercise.\nCurrently, Hafnium SPMC does not allow declaring dummy nodes in device region in any partition manifest. I cannot create a dedicated device region node to list the ESPI 5000 interrupt.",
      "parentUuid": "efe1f840_0b0d20db",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09612799_afa8b15e",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-09-26T15:27:58Z",
      "side": 1,
      "message": "Hi Madhu, sorry for not being clear. I was asking if we can create a node like follows:\nespi_fake_device_node {\n\t\t\t/* Fake region, reserved for test purposes */\n\t\t\tbase-address \u003d \u003c0x00000000 0x(some address in TZSRAM)\u003e;\n\t\t\tpages-count \u003d \u003c1\u003e; /* 1 4K Page */\n\t\t\tattributes \u003d \u003c0x3\u003e; /* read-write */\n\t\t\tinterrupts \u003d \u003c5000 0x900\u003e\n};\n\nWhy wont hafnium allow such nodes? Hafnium would just map that base address as device memory (when in fact it is really normal memory). You are wasting one page of memory the test, but do we care? It is for a test, and it provides clarity and avoids confusion.",
      "parentUuid": "15a46235_3501bd0f",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "780434dd_af1a46bc",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-09-26T15:48:26Z",
      "side": 1,
      "message": "My bad. By dummy node, I mistakenly assumed we were referring to a node which does not specify properties like base-address, page count etc.\n\nI think this might work. I will make the necessary change and test it.",
      "parentUuid": "09612799_afa8b15e",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6b66e6fa_d8e6ec0a",
        "filename": "spm/cactus/plat/arm/fvp/fdts/cactus.dts",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-09-26T21:42:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "780434dd_af1a46bc",
      "range": {
        "startLine": 122,
        "startChar": 5,
        "endLine": 122,
        "endChar": 17
      },
      "revId": "afe09546eecfd8856b70e2c8b17dee4878c1307e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}