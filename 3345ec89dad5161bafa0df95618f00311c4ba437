{
  "comments": [
    {
      "key": {
        "uuid": "88456f9f_a9206804",
        "filename": "spm/cactus/cactus.mk",
        "patchSetId": 5
      },
      "lineNbr": 58,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-07T14:55:35Z",
      "side": 1,
      "message": "Not sure this works. This is defining CACTUS_SEL1_SPMC but at this stage, it is neither defined to 1 or 0.\n\ne.g. on the C files command line I see -DCACTUS_SEL1_SPMC but the value is not defined when building eventually.",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "32f72e45_7ade0b8d",
        "filename": "spm/cactus/cactus.mk",
        "patchSetId": 5
      },
      "lineNbr": 58,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-07T21:30:56Z",
      "side": 1,
      "message": "The \u0027add_define\u0027 rule from cactus.mk introduces the define for the source files. This helps the compilation and the right code gets included.\n\nI added \u0027-DCACTUS_SEL1_SPMC +\u003d 0\u0027 to cactus.mk but ran into compilation issues with macro redifinition. Short answer, the current code works as expected. If we add \u0027-D...\u0027 we will have to delete the \u0027add_define\u0027 from the makefile leading to confusion.",
      "parentUuid": "88456f9f_a9206804",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "675bf9a7_5e23b12d",
        "filename": "spm/cactus/cactus.mk",
        "patchSetId": 5
      },
      "lineNbr": 58,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-10T08:28:26Z",
      "side": 1,
      "message": "It might work on your side for cactus-SPMC but it breaks the original cactus SP.\n-DCACTUS_SEL1_SPMC defines CACTUS_SEL1_SPMC for all variants.\nEverywhere #if CACTUS_SEL1_SPMC is used the conditional code gets compiled in.",
      "parentUuid": "32f72e45_7ade0b8d",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6551a952_5d7c4b5c",
        "filename": "spm/cactus/cactus.mk",
        "patchSetId": 5
      },
      "lineNbr": 58,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-13T04:39:24Z",
      "side": 1,
      "message": "I dont think that is accurate. Since CACTUS_SEL1_SPMC is not set to 0 or 1, #if CACTUS_SEL1_SPMC will actually compile the code out of the file.\n\nBut other than that, how do want to tackle this?",
      "parentUuid": "675bf9a7_5e23b12d",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23734565_049b1370",
        "filename": "spm/cactus/cactus.mk",
        "patchSetId": 5
      },
      "lineNbr": 58,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-14T08:08:35Z",
      "side": 1,
      "message": "Well if you have -DCACTUS_SEL1_SPMC always on the command line, then #if CACTUS_SEL1_SPMC code is compiled in even if it\u0027s not explicitly set to 1. The command line can be checked using verbose build (V\u003d1).\nThe truth is current change is breaking the CI related to this exact problem.\nI don\u0027t have a definitive answer but I guess this comes from that cactus.mk is included first in the top Makefile (where the define is declared without any value) and the platform makefile is included at the very last (where the define is actually set a sensible value).",
      "parentUuid": "6551a952_5d7c4b5c",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5dec7eea_0e370d59",
        "filename": "spm/common/sp_helpers.c",
        "patchSetId": 5
      },
      "lineNbr": 11,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-07T12:42:59Z",
      "side": 1,
      "message": "this breaks cactus_mm build\n\nthis leads to the question that spm_vcpu_get_count, spm_vm_get_count, spm_debug_log should rather be relocated locally to cactus",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "87449231_8ce4abe1",
        "filename": "spm/common/sp_helpers.c",
        "patchSetId": 5
      },
      "lineNbr": 11,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-07T21:30:56Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "5dec7eea_0e370d59",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "15b3c170_ee30a399",
        "filename": "spm/common/sp_helpers.c",
        "patchSetId": 5
      },
      "lineNbr": 11,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-07T21:32:47Z",
      "side": 1,
      "message": "This should be fixed with the latest patchset",
      "parentUuid": "87449231_8ce4abe1",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eb3578aa_5be53c15",
        "filename": "spm/common/sp_helpers.c",
        "patchSetId": 5
      },
      "lineNbr": 11,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2020-09-10T08:28:26Z",
      "side": 1,
      "message": "Back to this there was a rationale to make those wrappers common to all SPs (https://review.trustedfirmware.org/c/TF-A/tf-a-tests/+/4618)\nIn any case as said in another comment spm_vcpu_get_count, spm_vm_get_count are no longer relevant.",
      "parentUuid": "15b3c170_ee30a399",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf06c7d4_a0170b64",
        "filename": "spm/common/sp_helpers.c",
        "patchSetId": 5
      },
      "lineNbr": 11,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-13T04:04:15Z",
      "side": 1,
      "message": "What do you reckon? Should I just delete these functions altogether?",
      "parentUuid": "eb3578aa_5be53c15",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4836d572_2196c515",
        "filename": "spm/common/sp_helpers.c",
        "patchSetId": 5
      },
      "lineNbr": 11,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2020-09-13T04:39:24Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "bf06c7d4_a0170b64",
      "revId": "3345ec89dad5161bafa0df95618f00311c4ba437",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    }
  ]
}