{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "39cad9e7_05273e2b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000125
      },
      "writtenOn": "2021-03-08T21:37:20Z",
      "side": 1,
      "message": "I\u0027m wondering about hard-coded addresses given that not all platforms have identical memory maps.",
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d0f9238_b37bba99",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 57,
      "author": {
        "id": 1000125
      },
      "writtenOn": "2021-03-08T21:37:20Z",
      "side": 1,
      "message": "Could this be made relative to some existing #define, along the lines of TRUSTED_SRAM_BASE, so that this address can automatically adapt to the particular platform\u0027s memory map?",
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7a4bc2f6_2be7bb5e",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 57,
      "author": {
        "id": 1000125
      },
      "writtenOn": "2021-03-08T22:46:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8d0f9238_b37bba99",
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0df29d4_4aac8462",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 57,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2021-03-08T23:26:43Z",
      "side": 1,
      "message": "I found this memory region to be available after looking at all dts for various cactus partitions here:\nhttps://git.trustedfirmware.org/TF-A/tf-a-tests.git/tree/spm/cactus/plat/arm/fvp/fdts\n\nStrictly speaking, it is not located at an offset from SRAM_BASE. However, I will create a platform specific macro to capture this address.",
      "parentUuid": "8d0f9238_b37bba99",
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1a6ad7f0_70d2b67c",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 57,
      "author": {
        "id": 1000125
      },
      "writtenOn": "2021-03-22T22:22:54Z",
      "side": 1,
      "message": "Sounds good, thanks.",
      "parentUuid": "c0df29d4_4aac8462",
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e6a9302_3b81d1b7",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-02-03T03:06:06Z",
      "side": 1,
      "message": "Dont you need a barrier after this to ensure that your invalidates are complete before the reads below?",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "80b0c96f_230e0452",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2021-02-10T01:17:30Z",
      "side": 1,
      "message": "Hi Raghu\nI see that this macro is essentially a data cache operation on the virtual addresses in the range target_addr to target_addr+cpy_range. The addresses for the subsequent reads are also computed from target_addr. I was under the impression that this is a true dependency and the execution would essentially follow \"sequential consistency\" model. Hence, I did not use an explicit barrier such as DSB. Let me know your thoughts.\n\nfortunately, the macro has an implicit barrier: https://git.trustedfirmware.org/TF-A/tf-a-tests.git/tree/lib/aarch64/cache_helpers.S#n34",
      "parentUuid": "7e6a9302_3b81d1b7",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d1b7947_a5582f0c",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-02-10T02:23:20Z",
      "side": 1,
      "message": "It does. never mind :) Thanks.\nAs for true dependency, i dont know if the arch requires to honor the dependency between a cache maintenance instruction and a load... Do you know of a place in the ARM ARM that says it will be respected?\nI know it has to be respected between regular loads/stores but not sure if it needs to be respected between cache maint instructions and loads/stores..\nWould be great if you can show me in the ARM ARM or ask some one internally and let me know! :) \nInteresting case.",
      "parentUuid": "80b0c96f_230e0452",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "739449c1_7043dc09",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-02-10T13:52:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0d1b7947_a5582f0c",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d29d86c2_d0764325",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2021-02-10T23:27:17Z",
      "side": 1,
      "message": "I believe the dependency has to be respected between cache maintenance operation and a load. I could not find where exactly it is described in ARM ARM. However, From the barrier cook book[1], I found example in section 9.1.4 somewhat relevant to our scenario. In the instruction sequence from Thread P1, there is no barrier between the following 2 instructions: \n\nDCIMVAC R1 ; ensure cache discards stale copies before use\nLDR R5, [R1]\n\n\n[1] https://developer.arm.com/documentation/genc007826/latest",
      "parentUuid": "739449c1_7043dc09",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f7a7cfd2_4e853a52",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-02-11T02:26:27Z",
      "side": 1,
      "message": "So the cook book is REALLY old and almost predates ARMv8. I looked through the litmus test in the ARMv8 ARM(latest available online) and i dont see any example without a barrier after a data cache clean...",
      "parentUuid": "d29d86c2_d0764325",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fed0be20_fcaa2232",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2021-02-11T16:52:44Z",
      "side": 1,
      "message": "I see the same example in the new ARM ARM version G.a on page 8375(Section K11.5.1). Somehow the developer portal doesn\u0027t render the pdf and restricts to download only.",
      "parentUuid": "f7a7cfd2_4e853a52",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ec4e684b_6d684853",
        "filename": "spm/cactus/cactus_tests_smmuv3.c",
        "patchSetId": 1
      },
      "lineNbr": 171,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-02-11T17:33:44Z",
      "side": 1,
      "message": "Thanks Madhukar. Okay, i see it. I missed the last DC IVAC followed by LDR, was only seeing the invalidates before that. Looks like it is respected.\nThanks for entertaining the discussion! learnt something new!",
      "parentUuid": "fed0be20_fcaa2232",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 41
      },
      "revId": "98ce2f1740722cd2e5d60f52e9e4cd109c606c29",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}