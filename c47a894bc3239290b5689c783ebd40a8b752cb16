{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "abfa7466_e673c7cc",
        "filename": "tftf/tests/extensions/sme/test_sme.c",
        "patchSetId": 11
      },
      "lineNbr": 111,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2023-10-09T15:38:17Z",
      "side": 1,
      "message": "I wonder if we should use same pattern here, as in https://review.trustedfirmware.org/c/TF-A/tf-a-tests/+/21363/9/lib/extensions/sme/aarch64/sme.c#100\n\nSMCR_ELX_LEN_MASK defines 9 bits\nwhereas MASK(SMCR_ELX_LEN) defines 4 bits\n\nBits 4:8 are RAZ/WI but this doesn\u0027t say if they shall be forced to 0 from now e.g. to support future uses.\nSee some rationale here https://review.trustedfirmware.org/c/TF-A/tf-a-tests/+/21505/1/include/lib/aarch64/arch.h#b927\n\nEventually SMCR_ELX_LEN_MASK definition may go away if using MASK macro.",
      "range": {
        "startLine": 110,
        "startChar": 2,
        "endLine": 111,
        "endChar": 35
      },
      "revId": "c47a894bc3239290b5689c783ebd40a8b752cb16",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3aded5fe_13bb69e2",
        "filename": "tftf/tests/extensions/sme/test_sme.c",
        "patchSetId": 11
      },
      "lineNbr": 111,
      "author": {
        "id": 1000390
      },
      "writtenOn": "2023-10-10T10:11:55Z",
      "side": 1,
      "message": "\u003e I wonder if we should use same pattern here, as in https://review.trustedfirmware.org/c/TF-A/tf-a-tests/+/21363/9/lib/extensions/sme/aarch64/sme.c#100\n\nYes, we can do this. I will replace line 109-113 with sme_config_svq() as part this patch https://review.trustedfirmware.org/c/TF-A/tf-a-tests/+/21363 and we can remove SMCR_ELX_LEN_MASK.\n\n\n\u003e See some rationale here https://review.trustedfirmware.org/c/TF-A/tf-a-tests/+/21505/1/include/lib/aarch64/arch.h#b927\n\nAck, after writing 0x1ff and if we discover that the max supported architecture limit is greater that 0xf, there must be an assert as the space to hold Streaming Z registers is limited to 2048 bits. \n\nSimilar check is added in RMM at:\nhttps://git.trustedfirmware.org/TF-RMM/tf-rmm.git/tree/lib/arch/src/simd.c#n460\n\nhttps://git.trustedfirmware.org/TF-RMM/tf-rmm.git/tree/lib/arch/src/simd.c#n474",
      "parentUuid": "abfa7466_e673c7cc",
      "range": {
        "startLine": 110,
        "startChar": 2,
        "endLine": 111,
        "endChar": 35
      },
      "revId": "c47a894bc3239290b5689c783ebd40a8b752cb16",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fffdaf0a_30328a58",
        "filename": "tftf/tests/extensions/sme/test_sme.c",
        "patchSetId": 11
      },
      "lineNbr": 111,
      "author": {
        "id": 1000390
      },
      "writtenOn": "2023-10-10T11:49:56Z",
      "side": 1,
      "message": "\u003e Yes, we can do this. I will replace line 109-113 with sme_config_svq() as part this patch\n\nAfter looking at this code again, I feel replacing with sme_config_svq() must not be done as this function trying to enumerate all the possible SVQ from 0 to architecture limit. So iterating \u0027len_max\u0027 can go beyond 0xf it architecture supports any value beyond it.\n\nProbably, thinking to replace SME_SMCR_LEN_MAX with\n/*\n* SMCR_EL2_RAZ_LEN is defined to find the architecturally permitted SVL. This\n* is a combination of RAZ and LEN bit fields.\n*/\n#define SMCR_EL2_RAZ_LEN_SHIFT          UL(0)                                     \n#define SMCR_EL2_RAZ_LEN_WIDTH          UL(9)",
      "parentUuid": "3aded5fe_13bb69e2",
      "range": {
        "startLine": 110,
        "startChar": 2,
        "endLine": 111,
        "endChar": 35
      },
      "revId": "c47a894bc3239290b5689c783ebd40a8b752cb16",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}