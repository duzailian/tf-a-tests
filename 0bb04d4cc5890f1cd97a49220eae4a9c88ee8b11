{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "58f15e93_0702ba70",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 210,
      "author": {
        "id": 1000619
      },
      "writtenOn": "2023-01-17T21:58:01Z",
      "side": 1,
      "message": "Why is this test only for 1.1? Is RXTX buffer mapping not part of 1.0? At least according to the FFA spec it is. \n\nOr is TF-A only officially supporting 1.1? Just curious.",
      "range": {
        "startLine": 210,
        "startChar": 1,
        "endLine": 210,
        "endChar": 42
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "34759909_1ce4571b",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 210,
      "author": {
        "id": 1000341
      },
      "writtenOn": "2023-01-18T13:37:11Z",
      "side": 1,
      "message": "You are right. For v1.0 it is still relevant, given the OS kernel or the hypervisor need to do it to properly interact with SPMC. Reverted",
      "parentUuid": "58f15e93_0702ba70",
      "range": {
        "startLine": 210,
        "startChar": 1,
        "endLine": 210,
        "endChar": 42
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4f25ed68_a124bb4b",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 309,
      "author": {
        "id": 1000619
      },
      "writtenOn": "2023-01-17T21:58:01Z",
      "side": 1,
      "message": "Should this be more specifically \"the Non-secure physical FF-A instance\" to distinguish it from other physical instances (between secure components for example)?",
      "range": {
        "startLine": 309,
        "startChar": 39,
        "endLine": 309,
        "endChar": 65
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab1b27ce_65262577",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 309,
      "author": {
        "id": 1000341
      },
      "writtenOn": "2023-01-18T10:54:31Z",
      "side": 1,
      "message": "Can rephrase as suggested for clarity.",
      "parentUuid": "4f25ed68_a124bb4b",
      "range": {
        "startLine": 309,
        "startChar": 39,
        "endLine": 309,
        "endChar": 65
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8b5331d3_88c69c98",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 309,
      "author": {
        "id": 1000341
      },
      "writtenOn": "2023-01-18T13:37:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ab1b27ce_65262577",
      "range": {
        "startLine": 309,
        "startChar": 39,
        "endLine": 309,
        "endChar": 65
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "744dda79_75d0c1bc",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 313,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2023-01-13T20:06:56Z",
      "side": 1,
      "message": "cannot unmap the RX/TX buffer pair of an SP?",
      "range": {
        "startLine": 313,
        "startChar": 11,
        "endLine": 313,
        "endChar": 37
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c7372656_572372eb",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 313,
      "author": {
        "id": 1000341
      },
      "writtenOn": "2023-01-16T09:26:58Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "744dda79_75d0c1bc",
      "range": {
        "startLine": 313,
        "startChar": 11,
        "endLine": 313,
        "endChar": 37
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7f8be670_f1c49872",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 313,
      "author": {
        "id": 1000619
      },
      "writtenOn": "2023-01-17T21:58:01Z",
      "side": 1,
      "message": "It is unclear to me how this test distinguishes between a call of FFA_RXTX_UNMAP from the hypervisor (NS physical instance) vs a call of the same function from an SP.\n\nIf I understand correctly, a call from NS physical instance to unmap an SP\u0027s buffers should fail while a call from an SP to unmap its own buffers should be okay. \n\nWhat here indicates that the call is from the hypervisor? Is it the use of ffa_service_call? Maybe a comment could make this more clear.",
      "range": {
        "startLine": 312,
        "startChar": 52,
        "endLine": 313,
        "endChar": 11
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "62afdc8c_8e8efe05",
        "filename": "tftf/tests/runtime_services/secure_service/test_ffa_setup_and_discovery.c",
        "patchSetId": 1
      },
      "lineNbr": 313,
      "author": {
        "id": 1000341
      },
      "writtenOn": "2023-01-18T10:54:31Z",
      "side": 1,
      "message": "Check table Table 13.30 of the FF-A v1.1 EAC0 specification.\nIt describes that w1 can contain the VM ID, in case its IDs had been priorly mapped into the SPMC. This is to be used by the Hypervisor, sitting at NS-EL2 calling into the SPMC through the Physical FF-A instance.\nSimilar to what we do in our codebase:\nhttps://review.trustedfirmware.org/plugins/gitiles/hafnium/hafnium/+/refs/heads/master/src/arch/aarch64/plat/ffa/hypervisor.c#749\nThe recent patch: https://review.trustedfirmware.org/c/hafnium/hafnium/+/18761/3 \n... has added a check that the received w1 argument, if the call comes to hafnium from the hypervisor, that it only contains NWd IDs.\n\nBecause the hypervisor\u0027s implementation aims at being correct, we can\u0027t really force this test scenario in the hafnium CI\u0027s current test configuration. Hence adding a test to TF-A-Tests.\nTFTF (similar to a hypervisor) sits at NS-EL2. \nThe ffa_helpers are the wrapper calls to SMCs from SPs/TFTF into hafnium. However, there isn\u0027t yet a use in this codebase for the ffa_rxtx_unmap to receive the w1 argument to the wrapper call, besides this error return validation test. Thus, I decided to use the ffa_service_call(\u0026args).",
      "parentUuid": "7f8be670_f1c49872",
      "range": {
        "startLine": 312,
        "startChar": 52,
        "endLine": 313,
        "endChar": 11
      },
      "revId": "0bb04d4cc5890f1cd97a49220eae4a9c88ee8b11",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}